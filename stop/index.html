<!--
Train Live Schedule for MTR stop.
GitHub & Sponsor this project: https://github.com/sammyfung/mtrtrain
-->
<html lang="en">
<head>
<title>æ¸¯éµåˆ—è»Šå³æ™‚ç­æ¬¡ - æ£®è·¯æ­·ç¨‹</title>
<meta name="description" content="æ¸¯éµ, æ™‚é–“è¡¨, å±¯é¦¬ç¶«, å°‡è»æ¾³ç¶«, æ±æ¶Œç¶«, æ©Ÿå ´å¿«ç¶«, æ±éµç¶«, å—æ¸¯å³¶ç¶«, èƒç£ç¶«, è§€å¡˜ç¶«, MTR, Tuen Ma Line, TKO Line, Tung Chung Line, Airport Express Line, East Rail Line, South Island Line, Tsuen Wan Line, Island Line, Kwun Tong Line."/>
<meta charset="utf-8"/>
<style>
th,td { font-size: 32px; text-align: center; }
.std_text { font-size: 32px; }
.head_text { font-size: 48px; }
</style>
</head>
<body>
<h1 id='pagetitle' class='head_text'>æ¸¯éµåˆ—è»Šå³æ™‚ç­æ¬¡ - æ£®è·¯æ­·ç¨‹</h1>
<p class='std_text'>ğŸš† é¸æ“‡ç¶«è·¯ ğŸ‘‰ <a href="../?line=AEL">æ©Ÿå ´å¿«ç¶«</a> | <a href="../?line=TCL">æ±æ¶Œç¶«</a> | <a href="../?line=TKL">å°‡è»æ¾³ç¶«</a> | <a href="../?line=TML">å±¯é¦¬ç¶«</a> | <a href="../?line=EAL">æ±éµç¶«</a> | <a href="../?line=SIL">å—æ¸¯å³¶ç¶«</a> | <a href="../?line=TWL">èƒç£ç¶«</a> | <a href="../?line=ISL">æ¸¯å³¶ç·š</a> | <a href="../?line=KTL">è§€å¡˜ç¶«</a> | <a href="/mtrtrain/mtrtrain.html">English</a> .</p>
<p class='curr_time std_text'>âŒšï¸ ç¾åœ¨æ™‚é–“ï¼š</p>
<div id="timetables"></div>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0247336506883797"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-0247336506883797"
     data-ad-slot="9504048053"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<hr/>
<p class='curr_time std_text'>âŒšï¸ ç¾åœ¨æ™‚é–“ï¼š</p>
<p class='std_text'>ğŸš† é¸æ“‡ç¶«è·¯ ğŸ‘‰ <a href="../?line=AEL">æ©Ÿå ´å¿«ç¶«</a> | <a href="../?line=TCL">æ±æ¶Œç¶«</a> | <a href="../?line=TKL">å°‡è»æ¾³ç¶«</a> | <a href="../?line=TML">å±¯é¦¬ç¶«</a> | <a href="../?line=EAL">æ±éµç¶«</a> | <a href="../?line=SIL">å—æ¸¯å³¶ç¶«</a> | <a href="../?line=TWL">èƒç£ç¶«</a> | <a href="../?line=ISL">æ¸¯å³¶ç·š</a> | <a href="../?line=KTL">è§€å¡˜ç¶«</a> | <a href="/mtrtrain/mtrtrain.html">English</a> .</p>
<p class='std_text'>ğŸ‘¨â€ğŸ’» æ­¡è¿åˆ° <a href="https://github.com/sammyfung/mtrtrain" target="_blank">GitHub</a> å›é¥‹æ„è¦‹åŠ Sponsor æ”¯æŒ</p>
<p class='std_text'>ğŸ‘ æ•¸æ“šç”±é¦™æ¸¯æ”¿åºœ<a href='https://data.gov.hk/tc-data/dataset/mtr-data2-nexttrain-data'>é–‹æ”¾æ•¸æ“šå¹³å° DATA.GOV.HK</a>æä¾›</p>
<p class='std_text'>ğŸ™ è«‹å¤šå¤šç€è¦½<a href="https://sammy.hk" target="_blank">æ£®è·¯æ­·ç¨‹</a> ğŸ™</p>
</body>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K0FKV4F132"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K0FKV4F132');
</script>
<!--
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js">
</script>
<script>
const progname = 'æ¸¯éµåˆ—è»Šå³æ™‚ç­æ¬¡';
const tml = {
  'TUM': 'å±¯é–€', 'SIH': 'å…†åº·', 'TIS': 'å¤©æ°´åœ',
  'LOP': 'æœ—å±', 'YUL': 'å…ƒæœ—', 'KSR': 'éŒ¦ä¸Šè·¯',
  'TWW': 'èƒç£è¥¿', 'MEF': 'ç¾å­š', 'NAC': 'å—æ˜Œ',
  'AUS': 'æŸ¯å£«ç”¸', 'ETS': 'å°–æ±', 'HUH': 'ç´…ç£¡',
  'HOM': 'ä½•æ–‡ç”°', 'TKW': 'åœŸç“œç£', 'SUW': 'å®‹çš‡è‡º',
  'KAT': 'å•Ÿå¾·', 'DIH': 'é‘½çŸ³å±±', 'HIK': 'é¡¯å¾‘',
  'TAW': 'å¤§åœ', 'CKT': 'è»Šå…¬å»Ÿ', 'STW': 'æ²™ç”°åœ',
  'CIO': 'ç¬¬ä¸€åŸ', 'SHM': 'çŸ³é–€', 'TSH': 'å¤§æ°´å‘',
  'HEO': 'æ†å®‰', 'MOS': 'é¦¬éå±±', 'WKS': 'çƒæºªæ²™'
};
const tkl = {
	'POA': 'å¯¶ç³', 'HAH': 'å‘å£', 'LHP': 'åº·åŸ',
	'TKO': 'å°‡è»æ¾³', 'TIK': 'èª¿æ™¯å¶º', 'YAT': 'æ²¹å¡˜',
	'QUB': 'é°‚é­šæ¶Œ', 'NOP': 'åŒ—è§’'
};
const tcl = {
	'TUC': 'æ±æ¶Œ', 'SUN': 'æ¬£æ¾³', 'TSY': 'é’è¡£',
	'LAK': 'è”æ™¯', 'NAC': 'å—æ˜Œ', 'OLY': 'å¥§é‹',
	'KOW': 'ä¹é¾','HOK': 'é¦™æ¸¯'
};
const ael = {
	'AWE': 'åšè¦½é¤¨', 'AIR': 'æ©Ÿå ´', 'TSY': 'é’è¡£',
  'KOW': 'ä¹é¾', 'HOK': 'é¦™æ¸¯'
};
const eal = {
  'LMC': 'è½é¦¬æ´²', 'LOW': 'ç¾…æ¹–', 'SHS': 'ä¸Šæ°´',
  'FAN': 'ç²‰å¶º', 'TWO': 'å¤ªå’Œ', 'TAP': 'å¤§åŸ”å¢Ÿ',
  'UNI': 'å¤§å­¸', 'RAC': 'é¦¬å ´', 'FOT': 'ç«ç‚­', 
  'SHT': 'æ²™ç”°', 'TAW': 'å¤§åœ', 'KOT': 'ä¹é¾å¡˜',
  'MKK': 'æ—ºè§’æ±', 'HUH': 'ç´…ç£¡', 'EXC': 'æœƒå±•',
  'ADM': 'é‡‘é˜'
};
const sil = {
  'SOH': 'æµ·æ€¡åŠå³¶', 'LET': 'åˆ©æ±', 'WCH': 'é»ƒç«¹å‘',
  'OCP': 'æµ·æ´‹å…¬åœ’', 'ADM': 'é‡‘é˜'
};
const twl = {
  'TSW': 'èƒç£', 'TWH': 'å¤§çª©å£', 'KWH': 'è‘µèˆˆ',
  'KWF': 'è‘µèŠ³', 'LAK': 'èŒ˜æ™¯', 'MEF': 'ç¾å­š',
  'LCK': 'èŒ˜æè§’', 'CSW': 'é•·æ²™ç£', 'SSP': 'æ·±æ°´åŸ—',
  'PRE': 'å¤ªå­', 'MOK': 'æ—ºè§’', 'YMT': 'æ²¹éº»åœ°',
  'JOR': 'ä½æ•¦', 'TST': 'å°–æ²™å’€', 'ADM': 'é‡‘é˜',
  'CEN': 'ä¸­ç’°'
}; 
const isl = {
  'CHW': 'æŸ´ç£', 'HFC': 'æèŠ±é‚¨', 'SKW': 'ç­²ç®•ç£',
  'SWH': 'è¥¿ç£æ²³', 'TAK': 'å¤ªå¤', 'QUB': 'é°‚é­šæ¶Œ',
  'NOP': 'åŒ—è§’', 'FOH': 'ç‚®å°å±±', 'TIH': 'å¤©å',
  'CAB': 'éŠ…é‘¼ç£', 'WAC': 'ç£ä»”', 'ADM': 'é‡‘é˜',
  'CEN': 'ä¸­ç’°', 'SHW': 'ä¸Šç’°', 'SYP': 'è¥¿ç‡Ÿç›¤',
  'HKU': 'é¦™æ¸¯å¤§å­¸', 'KET': 'å …å°¼åœ°åŸ'
};
const ktl = {
  'TIK': 'èª¿æ™¯å¶º', 'YAT': 'æ²¹å¡˜', 'LAT': 'è—ç”°',
  'KWT': 'è§€å¡˜', 'NTK': 'ç‰›é ­è§’', 'KOB': 'ä¹é¾ç£',
  'CHH': 'å½©è™¹', 'DIH': 'é‘½çŸ³å±±', 'WTS': 'é»ƒå¤§ä»™',
  'LOF': 'æ¨‚å¯Œ', 'KOT': 'ä¹é¾å¡˜', 'SKM': 'çŸ³ç¡¤å°¾',
  'PRE': 'å¤ªå­', 'MOK': 'æ—ºè§’', 'YMT': 'æ²¹éº»åœ°',
  'HOM': 'ä½•æ–‡ç”°', 'WHA': 'é»ƒåŸ”'
};
const mtrlines = [tml, tkl, tcl, ael, eal, sil, twl, isl, ktl];
const mtrline_codes = 
  ['TML', 'TKL', 'TCL', 'AEL', 'EAL', 'SIL', 'TWL', 'ISL', 'KTL'];
const mtrline_names = 
  ['å±¯é¦¬ç¶«', 'å°‡è»æ¾³ç¶«', 'æ±æ¶Œç¶«', 'æ©Ÿå ´å¿«ç¶«', 'æ±éµç¶«', 'å—æ¸¯å³¶ç¶«', 'èƒç£ç¶«', 'æ¸¯å³¶ç·š', 'è§€å¡˜ç¶«'];

var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
};

const stop = getUrlParameter('stop');
var line_count = 0;
var curr_time = undefined;
var stop_name = undefined;

for (const mtrline of mtrlines) {

  console.log(mtrline);
  console.log(mtrline_names[line_count]);
    if (mtrline.hasOwnProperty(stop)) {
      document.title = mtrline[stop] + ' - ' + progname + ' | æ£®è·¯æ­·ç¨‹';
      $('#pagetitle').html(document.title);

      const line_code = mtrline_codes[line_count].toLowerCase();
      const timetable = `<div>
          <p><h2 class='std_text'><a href='../?line=` + mtrline_codes[line_count]+ "'>"+mtrline_names[line_count]+'</a></h2></p>' +
          `<table border='1' id='${line_code}table' width='100%'>
          <tr><th>Direction</th><th>1</th><th>2</th><th>3</th><th>4</th></tr>` +
          `<tr id='${line_code}down'><td>â¬‡ï¸ <div id='${line_code}downplat'>ä¸‹è¡Œåˆ—è»Š</div></td></tr>
          <tr id='${line_code}up'><td>â¬†ï¸ <div id='${line_code}upplat'>ä¸Šè¡Œåˆ—è»Š</div></td></tr>`
          "</table></div>";
      $('#timetables').append(timetable);
      
      var url = 'https://rt.data.gov.hk/v1/transport/mtr/getSchedule.php?line=' + mtrline_codes[line_count] + '&sta=' + stop;
      $.getJSON(url, function( data ) {
        var downitems = [];
        var upitems = [];
        if (curr_time == undefined) {
          curr_time = data.curr_time;
          $('.curr_time').html("âŒšï¸ ç¾åœ¨æ™‚é–“ï¼š" + curr_time);
        };
        if (stop_name == undefined) {
          stop_name = mtrline[stop];
          $('.curr_time').html("âŒšï¸ ç¾åœ¨æ™‚é–“ï¼š" + curr_time);
        };
        $.each( data.data, function( key, val ) {
          $.each( val.DOWN, function( key, val ) {
            if (parseInt(key) < 4) {
              time = val.time;
              $(`#${line_code}downplat`).html(`æœˆå°${val.plat}`);
              time = time.replace(/^[0-9-]* /, '');	       
              time = time.replace(/:[0-9]*$/, '');      
              $(`#${line_code}down`).append( "<td id='" + key + "'>" + time + " (" + mtrline[val.dest] + ") " + "</td>" );
            };
          });
          $.each( val.UP, function( key, val ) {
            if (parseInt(key) < 4) {
              time = val.time;
              $(`#${line_code}upplat`).html(`æœˆå°${val.plat}`);
              time = time.replace(/^[0-9-]* /, '');
              time = time.replace(/:[0-9]*$/, '');		 
              upitems.push( "<td id='" + key + "'>" + time + " (" + val.dest + ") " + "</td>" );
              $(`#${line_code}up`).append( "<td id='" + key + "'>" + time + " (" + mtrline[val.dest] + ") " + "</td>" );

            }
          });   
        });
      });  
    }
    line_count += 1;
}
/*** Pls EDIT above, the following are old**/ 
/*
$('#down_track').html('â¬‡ï¸ ä¸‹è¡Œåˆ—è»Š â¡ï¸ å¾€' + $down_terminus_name + 'æ–¹å‘');
$('#up_track').html('â¬†ï¸ ä¸Šè¡Œåˆ—è»Š â¡ï¸ å¾€' + $up_terminus_name + 'æ–¹å‘');
$url_prefix = 'https://rt.data.gov.hk/v1/transport/mtr/getSchedule.php';
let url = [];
for ($station in Object.keys($stations)) {
  url.push($url_prefix + '?line=' + $line + '&sta=' + Object.keys($stations)[$station]);
}
$.ajaxSetup({
async: false
});
curr_time = undefined;
for ($i in url) {
  //console.log(url[$i]);
  $.getJSON(url[$i], function( data ) {
    //console.log(data);
    var downitems = [];
    var upitems = [];
    if (curr_time == undefined) {
      curr_time = data.curr_time;
      $('.curr_time').html("âŒšï¸ ç¾åœ¨æ™‚é–“ï¼š" + curr_time);
    };
    $.each( data.data, function( key, val ) {
       stopcode = key.replace($line + '-', ''); 	    
       downitems.push('<th>' + $stations[stopcode] + ' (' + stopcode + ')</th>');
       $.each( val.DOWN, function( key, val ) {
         if (parseInt(key) < 4) {
           time = val.time;
           time = time.replace(/^[0-9-]* /, '');	       
    	   time = time.replace(/:[0-9]*$/, '');      
	   downitems.push( "<td id='" + key + "'>" + time + " (" + val.dest + ") " + "</td>" );
         };
       });
       upitems.push('<th>' + $stations[stopcode] + ' (' + stopcode + ')</th>');
       $.each( val.UP, function( key, val ) {
         if (parseInt(key) < 4) {
           time = val.time;
           time = time.replace(/^[0-9-]* /, '');
           time = time.replace(/:[0-9]*$/, '');		 
           upitems.push( "<td id='" + key + "'>" + time + " (" + val.dest + ") " + "</td>" );
         }
       });   
    });
    $( "<tr/>", {
      "class": "station-row", 
      html: downitems.join( "" )
    }).appendTo( $("#down") );
    $( "<tr/>", {
      "class": "station-row",
      html: upitems.join( "" )
    }).prependTo( $("#up") );
  })
  .fail(function() {
    console.log( "error" );
  });
}
    $( "<tr/>", {
      "class": "station-row",
      //html: "<th>è»Šç«™</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th>"
      html: "<th>è»Šç«™</th><th>1</th><th>2</th><th>3</th><th>4</th>"
    }).prependTo( $("#up") );
//console.log('END');
*/
</script>
</html>
